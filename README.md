# NRAS

The project is designed to use a collection of indicators to flag and calculate scenarios in which to decide stations that should be upgraded to a step free and accessible category (A and B1)


## Dashboard Script

This script is written and design to calculate scenario data relating to an upgrade or change in station categories allowing the user to run the code in PowerBi and view the new values in the KPIs dynamically. 

Inputs:

`Input template.csv` - this is a csv file containing the station codes and new category label of all stations to be upgraded in a given scenario, the input template represents a scenario 

`Step Free Scoring.xlsx` - this is a workbook previously created, containing the base scores and categories for all stations, this is read in as an input to be the template for the upgraded categories/scenario 

`MOIRAOD.accdb` - the access database that is provided by NR, this provides the list of all stations, their categories and journey data, in the form of an O-D Matrix, this is read in a template for the journey data calculations 

### What the script does: 

```
def spreadsheet():
```

1. The script reads in the step free scoring xlsx workbook and extracts the sheets `‘All_Stations, St_cat’` into dataframes 

2. The script then reads in the OD Matrix and the input csv; defined by the user before running, into data frames and updates the station categories by the values defined in the input csv 

3. The number of unlocked journeys, potential rank and connectivity rank are computed, 

4. The mobility and isolation scores including the revisited isolation scores are calculated  

5. All the columns after mobility score in the dataframe made from All_Stations are blanked with empty values for stations that are accessible 

6. The total journeys are grouped by station and are outputted to a new spreadsheet with the updated categories listed 

### Outputs: 

- `New OD Matrix (PowerBi Table):` Generated by the MOIRAOD database and the input template csv, the stations reflect the upgraded stations from the csv 

- `Final DF/All Stations_sc (PowerBi Table) ` A table generated from the xlsx file and the input csv, this table contains all the stations, their categories (including upgraded), accessibility flags, connectivity and journey data, mobility data and socio-economic data scorings. 

### Scenario Spreadsheets 

Spreadsheet generated from the xlsx, input csv and the MOIRAOD file, the sheets `‘st_cat’`, `Inaccessible O Accessi D`, `Accessible O Inaccessi D` are all updated to relefect the new categories  
